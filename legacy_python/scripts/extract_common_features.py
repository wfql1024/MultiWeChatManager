import re
from typing import List


def extract_common_features(hex_list: List[str], placeholder: str = "??", remove_chars: str = "̲") -> str:
    def clean(s: str) -> List[str]:
        # 删除指定字符
        for ch in remove_chars:
            s = s.replace(ch, "")
        # 压缩空格，统一大写
        s = re.sub(r"\s+", " ", s.strip()).upper()
        return s.split()

    cleaned = [clean(s) for s in hex_list]

    # 确认长度一致
    length = len(cleaned[0])
    if not all(len(x) == length for x in cleaned):
        raise ValueError("输入的 hex 串长度不一致")

    # 每一列比对
    result = []
    for i in range(length):
        col = {row[i] for row in cleaned}
        result.append(col.pop() if len(col) == 1 else placeholder)

    return " ".join(result)


if __name__ == "__main__":
    # 示例
    # 气泡防撤回片段1原始串: 4.1.0.18/21/29
    hex_list_010000 = [
        "48 89 54 24 10 55 41 57 41 56 41 55 41 54 56 57 53 48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 2B 3D 97 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC ̲5̲5 ̲5̲6 ̲5̲7 ̲5̲3 ̲4̲8 ̲8̲1 ̲E̲C ̲6̲8 ̲0̲2 ̲0̲0 ̲0̲0 ̲4̲8 ̲8̲D ̲A̲C ̲2̲4 ̲8̲0 00 ̲0̲0 ̲0̲0 ̲4̲8 ̲C̲7 ̲8̲5 ̲E̲0 ̲0̲1 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2 AA E8 08 02 50 04 48 89 D9 48 89 F2 E8 CD 97 99 00 48 89 F9 48 89 DA E8 52 00 00 00 48 8D 4D A0 E8 99 E9 63 FF B0 01 48 81 C4 68 02 00 00",
        "48 89 54 24 10 55 41 57 41 56 41 55 41 54 56 57 53 48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 9B F6 96 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC ̲5̲5 ̲5̲6 ̲5̲7 ̲5̲3 ̲4̲8 ̲8̲1 ̲E̲C ̲6̲8 ̲0̲2 ̲0̲0 ̲0̲0 ̲4̲8 ̲8̲D ̲A̲C ̲2̲4 ̲8̲0 00 ̲0̲0 ̲0̲0 ̲4̲8 ̲C̲7 ̲8̲5 ̲E̲0 ̲0̲1 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2 AA E8 38 B5 4F 04 48 89 D9 48 89 F2 E8 CD 3C 99 00 48 89 F9 48 89 DA E8 52 00 00 00 48 8D 4D A0 E8 09 A3 63 FF B0 01 48 81 C4 68 02 00 00",
        "48 89 54 24 10 55 41 57 41 56 41 55 41 54 56 57 53 48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 AB 11 96 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC ̲5̲5 ̲5̲6 ̲5̲7 ̲5̲3 ̲4̲8 ̲8̲1 ̲E̲C ̲6̲8 ̲0̲2 ̲0̲0 ̲0̲0 ̲4̲8 ̲8̲D ̲A̲C ̲2̲4 ̲8̲0 ̲0̲0 ̲0̲0 ̲0̲0 ̲4̲8 ̲C̲7 ̲8̲5 ̲E̲0 ̲0̲1 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2 AA E8 48 93 55 04 48 89 D9 48 89 F2 E8 6D 1D 9A 00 48 89 F9 48 89 DA E8 52 00 00 00 48 8D 4D A0 E8 A9 20 5E FF B0 01 48 81 C4 68 02 00 00"
    ]
    # 气泡防撤回片段1补丁串: 4.1.0.18/21/29
    hex_list_010001 = [
        "48 89 54 24 10 55 41 57 41 56 41 55 41 54 56 57 53 48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 2B 3D 97 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC ̲C̲3 ̲3̲D ̲1̲2 ̲2̲7 ̲0̲0 ̲0̲0 ̲0̲F ̲8̲4 ̲9̲9 ̲E̲B ̲F̲6 ̲0̲0 ̲E̲9 ̲E̲F ̲F̲2 ̲F̲6 00 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2 AA E8 08 02 50 04 48 89 D9 48 89 F2 E8 CD 97 99 00 48 89 F9 48 89 DA E8 52 00 00 00 48 8D 4D A0 E8 99 E9 63 FF B0 01 48 81 C4 68 02 00 00",
        "48 89 54 24 10 55 41 57 41 56 41 55 41 54 56 57 53 48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 9B F6 96 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC ̲C̲3 ̲3̲D ̲1̲2 ̲2̲7 ̲0̲0 ̲0̲0 ̲0̲F ̲8̲4 ̲9̲9 ̲9̲0 ̲F̲6 ̲0̲0 ̲E̲9 ̲E̲F ̲9̲7 ̲F̲6 00 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2 AA E8 38 B5 4F 04 48 89 D9 48 89 F2 E8 CD 3C 99 00 48 89 F9 48 89 DA E8 52 00 00 00 48 8D 4D A0 E8 09 A3 63 FF B0 01 48 81 C4 68 02 00 00",
        "48 89 54 24 10 55 41 57 41 56 41 55 41 54 56 57 53 48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 AB 11 96 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC ̲C̲3 ̲3̲D ̲1̲2 ̲2̲7 ̲0̲0 ̲0̲0 ̲0̲F ̲8̲4 ̲A̲E ̲0̲F ̲0̲4 ̲0̲1 ̲E̲9 ̲F̲F ̲1̲6 ̲0̲4 ̲0̲1 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 ̲9̲0 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2 AA E8 48 93 55 04 48 89 D9 48 89 F2 E8 6D 1D 9A 00 48 89 F9 48 89 DA E8 52 00 00 00 48 8D 4D A0 E8 A9 20 5E FF B0 01 48 81 C4 68 02 00 00"
    ]

    # 气泡防撤回片段1补丁串偏移1: 4.1.0.18/21/29
    hex_list_010001_offset00 = [
        "DF 02 48 8D 8D 08 01 00 00 48 8D 15 2D 87 ED 04 4C 8D 05 A8 7A ED 04 41 B9 E2 02 00 00 E8 59 2D E2 FD 48 8D 8D 08 01 00 00 B2 01 E8 3B F9 E1 FD 48 8B 8D F0 02 00 00 4C 89 F2 E8 BC 74 FF FF 84 C0 0F 85 44 07 00 00 4C 8B BD 28 03 00 00 4C 3B BD 30 03 00 00 0F 84 6A 02 00 00 4C 89 F9 4C 89 F2",
        "DF 02 48 8D 8D 08 01 00 00 48 8D 15 8B 9B ED 04 4C 8D 05 06 8F ED 04 41 B9 E2 02 00 00 E8 E9 0B E2 FD 48 8D 8D 08 01 00 00 B2 01 E8 CB D7 E1 FD 48 8B 8D F0 02 00 00 4C 89 F2 E8 BC 74 FF FF 84 C0 0F 85 44 07 00 00 4C 8B BD 28 03 00 00 4C 3B BD 30 03 00 00 0F 84 6A 02 00 00 4C 89 F9 4C 89 F2",
        "C1 E8 64 F2 D7 02 48 8D 8D B8 00 00 00 48 89 DA 4C 8D 05 90 44 E7 04 41 B9 BD 02 00 00 E8 94 96 CE FD 48 8D 8D B8 00 00 00 B2 01 E8 76 62 CE FD 48 8B 8D C0 02 00 00 4C 89 F2 E8 17 77 FF FF 84 C0 0F 85 3F 07 00 00 4C 8B BD F8 02 00 00 4C 3B BD 00 03 00 00 0F 84 61 02 00 00 4C 89 F9 4C 89 F2"
    ]

    # 气泡防撤回片段1补丁串偏移2: 4.1.0.18/21/29
    hex_list_010001_offset01 = [
        "01 00 00 B2 01 E8 06 F2 E1 FD 48 8D 8D 20 03 00 00 48 8D 95 46 03 00 00 44 0F B6 85 47 03 00 00 E8 0B 67 00 00 4C 89 F1 E8 13 B3 DC FF 0F 1F 00 !48 8B 85 38 02 00 00 48 83 F8 10 49 BF CD CC CC CC CC CC CC CC 0F 82 AA F2 FF FF 48 8B 8D 20 02 00 00 48 8D 50 01 48 81 FA 00 10 00 00 0F 82 8D F2",
        "01 00 00 B2 01 E8 96 D0 E1 FD 48 8D 8D 20 03 00 00 48 8D 95 46 03 00 00 44 0F B6 85 47 03 00 00 E8 0B 67 00 00 4C 89 F1 E8 13 B3 DC FF 0F 1F 00 !48 8B 85 38 02 00 00 48 83 F8 10 49 BF CD CC CC CC CC CC CC CC 0F 82 AA F2 FF FF 48 8B 8D 20 02 00 00 48 8D 50 01 48 81 FA 00 10 00 00 0F 82 8D F2",
        "48 8D 8D F0 02 00 00 48 8D 95 16 03 00 00 44 0F B6 85 17 03 00 00 E8 95 48 00 00 4C 89 F1 E8 2D E0 DB FF 66 66 66 66 2E 0F 1F 84 00 00 00 00 00 !48 8B 85 10 02 00 00 48 83 F8 10 49 BF CD CC CC CC CC CC CC CC 0F 82 C4 F2 FF FF 48 8B 8D F8 01 00 00 48 8D 50 01 48 81 FA 00 10 00 00 0F 82 A7 F2",
    ]

    # 气泡防撤回片段2原始串: 4.1.0.18/21/29
    hex_list_010100 = [
        "78 ED 04 41 B9 D9 02 00 00 E8 EC 2A E2 FD 48 8D 8D 08 01 00 00 B2 01 E8 CE F6 E1 FD 48 8D 8D 20 03 00 00 48 8D 95 46 03 00 00 44 0F B6 85 47 03 00 00 E8 D3 6B 00 00 4C 89 F2 E8 7B 6D 00 00 E9 ̲C̲6 ̲0̲4 ̲0̲0 ̲0̲0 48 8D 8D 20 03 00 00 4C 89 FA 4D 89 F0 E8 84 FA 00 00 E9 AF 04 00 00 48 01 D2 49 8B 0C D4 4C 8B B5 48 02 00 00 90 49 39 CB 0F 84 97 04 00 00 4D 8B 5B 08 49 3B 43 10 75 ED 4D 85 DB 0F 84 84 04 00 00 4D 39 D3 0F 84 7B 04 00 00 41 8B 4B 18 83 F9 05 77 61 B8 26 00 00 00 0F A3 C8",
        "8C ED 04 41 B9 D9 02 00 00 E8 7C 09 E2 FD 48 8D 8D 08 01 00 00 B2 01 E8 5E D5 E1 FD 48 8D 8D 20 03 00 00 48 8D 95 46 03 00 00 44 0F B6 85 47 03 00 00 E8 D3 6B 00 00 4C 89 F2 E8 7B 6D 00 00 E9 ̲C̲6 ̲0̲4 ̲0̲0 ̲0̲0 48 8D 8D 20 03 00 00 4C 89 FA 4D 89 F0 E8 84 FA 00 00 E9 AF 04 00 00 48 01 D2 49 8B 0C D4 4C 8B B5 48 02 00 00 90 49 39 CB 0F 84 97 04 00 00 4D 8B 5B 08 49 3B 43 10 75 ED 4D 85 DB 0F 84 84 04 00 00 4D 39 D3 0F 84 7B 04 00 00 41 8B 4B 18 83 F9 05 77 61 B8 26 00 00 00 0F A3 C8",
        "42 E7 04 41 B9 B4 02 00 00 E8 30 94 CE FD 48 8D 8D B8 00 00 00 B2 01 E8 12 60 CE FD 48 8D 8D F0 02 00 00 48 8D 95 16 03 00 00 44 0F B6 85 17 03 00 00 E8 57 4D 00 00 4C 89 F2 E8 FF 4E 00 00 E9 ̲C̲A ̲0̲4 ̲0̲0 ̲0̲0 48 8D 8D F0 02 00 00 4C 89 FA 4D 89 F0 E8 08 DC 00 00 E9 B3 04 00 00 48 01 D2 49 8B 0C D4 48 8D 1D 0E 4C E7 04 4C 8B B5 E8 02 00 00 66 66 66 66 66 2E 0F 1F 84 00 00 00 00 00 49 39 CB 0F 84 87 04 00 00 4D 8B 5B 08 49 3B 43 10 75 ED 4D 85 DB 0F 84 74 04 00 00 4D 39 D3 0F 84 6B"
    ]
    # 气泡防撤回片段2原始串: 4.1.0.18/21/29
    hex_list_010101 = [
        "78 ED 04 41 B9 D9 02 00 00 E8 EC 2A E2 FD 48 8D 8D 08 01 00 00 B2 01 E8 CE F6 E1 FD 48 8D 8D 20 03 00 00 48 8D 95 46 03 00 00 44 0F B6 85 47 03 00 00 E8 D3 6B 00 00 4C 89 F2 E8 7B 6D 00 00 E9 ̲C̲7 ̲1̲1 ̲0̲9 ̲F̲F 48 8D 8D 20 03 00 00 4C 89 FA 4D 89 F0 E8 84 FA 00 00 E9 AF 04 00 00 48 01 D2 49 8B 0C D4 4C 8B B5 48 02 00 00 90 49 39 CB 0F 84 97 04 00 00 4D 8B 5B 08 49 3B 43 10 75 ED 4D 85 DB 0F 84 84 04 00 00 4D 39 D3 0F 84 7B 04 00 00 41 8B 4B 18 83 F9 05 77 61 B8 26 00 00 00 0F A3 C8",
        "8C ED 04 41 B9 D9 02 00 00 E8 7C 09 E2 FD 48 8D 8D 08 01 00 00 B2 01 E8 5E D5 E1 FD 48 8D 8D 20 03 00 00 48 8D 95 46 03 00 00 44 0F B6 85 47 03 00 00 E8 D3 6B 00 00 4C 89 F2 E8 7B 6D 00 00 E9 ̲C̲7 ̲6̲C ̲0̲9 ̲F̲F 48 8D 8D 20 03 00 00 4C 89 FA 4D 89 F0 E8 84 FA 00 00 E9 AF 04 00 00 48 01 D2 49 8B 0C D4 4C 8B B5 48 02 00 00 90 49 39 CB 0F 84 97 04 00 00 4D 8B 5B 08 49 3B 43 10 75 ED 4D 85 DB 0F 84 84 04 00 00 4D 39 D3 0F 84 7B 04 00 00 41 8B 4B 18 83 F9 05 77 61 B8 26 00 00 00 0F A3 C8",
        "42 E7 04 41 B9 B4 02 00 00 E8 30 94 CE FD 48 8D 8D B8 00 00 00 B2 01 E8 12 60 CE FD 48 8D 8D F0 02 00 00 48 8D 95 16 03 00 00 44 0F B6 85 17 03 00 00 E8 57 4D 00 00 4C 89 F2 E8 FF 4E 00 00 E9 ̲B̲B ̲E̲D ̲F̲B ̲F̲E 48 8D 8D F0 02 00 00 4C 89 FA 4D 89 F0 E8 08 DC 00 00 E9 B3 04 00 00 48 01 D2 49 8B 0C D4 48 8D 1D 0E 4C E7 04 4C 8B B5 E8 02 00 00 66 66 66 66 66 2E 0F 1F 84 00 00 00 00 00 49 39 CB 0F 84 87 04 00 00 4D 8B 5B 08 49 3B 43 10 75 ED 4D 85 DB 0F 84 74 04 00 00 4D 39 D3 0F 84 6B"
    ]

    # 气泡防撤回片段2补丁串偏移1目标: 4.1.0.18/21/29
    hex_list_010101_offset00 = [
        "48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 2B 3D 97 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC C3 3D 12 27 00 00 0F 84 99 EB F6 00 E9 EF F2 F6 00 90 90 90 90 90 90 90 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2",
        "48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 9B F6 96 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC C3 3D 12 27 00 00 0F 84 99 90 F6 00 E9 EF 97 F6 00 90 90 90 90 90 90 90 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2",
        "48 83 EC 48 48 8D AA 80 00 00 00 48 8D 4D 60 E8 AB 11 96 FF 90 48 83 C4 48 5B 5F 5E 41 5C 41 5D 41 5E 41 5F 5D C3 CC CC CC CC CC CC CC CC CC C3 3D 12 27 00 00 0F 84 AE 0F 04 01 E9 FF 16 04 01 90 90 90 90 90 90 90 00 00 FE FF FF FF 48 89 D6 48 89 CF 48 8D 5D A0 41 B8 40 02 00 00 48 89 D9 B2"
    ]

    # 通知防撤回片段1原始串: 4.1.0.21/34
    hex_list_020000 = [
        "8D 70 01 00 00 48 8D 95 78 01 00 00 E8 8D 80 F8 FE 4C 8D 05 2E D1 16 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 73 80 F8 FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 A0 7A F8 FE 48 8D ̲9̲7 ̲B̲0 ̲0̲1 ̲0̲0 ̲0̲0 ̲4̲8 83 ̲B̲F ̲C̲8 ̲0̲1 ̲0̲0 ̲0̲0 ̲1̲0 ̲7̲2 ̲0̲3 ̲4̲8 ̲8̲B ̲1̲2 48 8D 8D 80 00 00 00 E8 40 B2 F8 FE 4C 8D 05 C6 D4 42 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 26 80 F8 FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 53 7A F8 FE 8B 97 90 02 00 00 48 8D 8D 80 00 00 00 E8 41 B3 F8 FE 4C 89 B5",
        "8D 70 01 00 00 48 8D 95 78 01 00 00 E8 5D 7E FA FE 4C 8D 05 1E 80 11 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 43 7E FA FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 70 78 FA FE 48 8D ̲9̲7 ̲B̲0 ̲0̲1 ̲0̲0 ̲0̲0 ̲4̲8 83 ̲B̲F ̲C̲8 ̲0̲1 ̲0̲0 ̲0̲0 ̲1̲0 ̲7̲2 ̲0̲3 ̲4̲8 ̲8̲B ̲1̲2 48 8D 8D 80 00 00 00 E8 10 B0 FA FE 4C 8D 05 26 35 3D 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 F6 7D FA FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 23 78 FA FE 8B 97 90 02 00 00 48 8D 8D 80 00 00 00 E8 11 B1 FA FE 4C 89 B5"
    ]

    # 通知防撤回片段1补丁串: 4.1.0.21/34
    hex_list_020001 = [
        "8D 70 01 00 00 48 8D 95 78 01 00 00 E8 8D 80 F8 FE 4C 8D 05 2E D1 16 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 73 80 F8 FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 A0 7A F8 FE 48 8D ̲1̲5 ̲E̲D ̲3̲B ̲9̲2 ̲0̲6 ̲4̲9 83 ̲F̲D ̲2̲F ̲7̲4 ̲0̲7 ̲4̲8 ̲8̲D ̲1̲5 ̲4̲2 ̲3̲C ̲9̲2 ̲0̲6 48 8D 8D 80 00 00 00 E8 40 B2 F8 FE 4C 8D 05 C6 D4 42 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 26 80 F8 FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 53 7A F8 FE 8B 97 90 02 00 00 48 8D 8D 80 00 00 00 E8 41 B3 F8 FE 4C 89 B5",
        "8D 70 01 00 00 48 8D 95 78 01 00 00 E8 5D 7E FA FE 4C 8D 05 1E 80 11 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 43 7E FA FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 70 78 FA FE 48 8D ̲1̲5 ̲8̲3 ̲8̲3 ̲8̲9 ̲0̲6 ̲4̲9 83 ̲F̲D ̲2̲F ̲7̲4 ̲0̲7 ̲4̲8 ̲8̲D ̲1̲5 ̲D̲8 ̲8̲3 ̲8̲9 ̲0̲6 48 8D 8D 80 00 00 00 E8 10 B0 FA FE 4C 8D 05 26 35 3D 05 48 8D 8D 78 01 00 00 48 8D 95 80 01 00 00 E8 F6 7D FA FE 48 8D 8D 80 01 00 00 48 8D 95 80 00 00 00 E8 23 78 FA FE 8B 97 90 02 00 00 48 8D 8D 80 00 00 00 E8 11 B1 FA FE 4C 89 B5"
    ]

    # 通知防撤回片段1补丁串偏移1: 4.1.0.29/34
    hex_list_020001_offset00 = [
        "A7 BB E9 99 A4 00 E5 B7 B2 E9 82 80 E8 AB 8B E5 B0 8D E6 96 B9 E6 88 90 E7 82 BA E4 BD A0 E7 9A 84 E7 9B A3 E8 AD B7 E4 BA BA EF BC 8C E8 AB 8B !E7 AD 89 E5 80 99 E5 B0 8D E6 96 B9 E5 90 8C E6 84 8F E3 80 82 00 E6 9C AA E6 88 90 E5 B9 B4 E4 BA BA E6 A8 A1 E5 BC 8F E4 B8 8B E6 AD A4 E5 8A 9F",
        "A7 BB E9 99 A4 00 E5 B7 B2 E9 82 80 E8 AB 8B E5 B0 8D E6 96 B9 E6 88 90 E7 82 BA E4 BD A0 E7 9A 84 E7 9B A3 E8 AD B7 E4 BA BA EF BC 8C E8 AB 8B !E7 AD 89 E5 80 99 E5 B0 8D E6 96 B9 E5 90 8C E6 84 8F E3 80 82 00 E6 9C AA E6 88 90 E5 B9 B4 E4 BA BA E6 A8 A1 E5 BC 8F E4 B8 8B E6 AD A4 E5 8A 9F"
    ]

    # 通知防撤回片段1补丁串偏移2: 4.1.0.29/34
    hex_list_020001_offset01 = [
        "83 BD E4 B8 8D E5 8F AF E5 AD 98 E5 8F 96 00 E6 9C AA E6 88 90 E5 B9 B4 E4 BA BA E6 A8 A1 E5 BC 8F E4 B8 8B E6 AD A4 E5 8A 9F E8 83 BD E4 B8 8D !E5 8F AF E5 AD 98 E5 8F 96 00 E4 BD A0 E5 B7 B2 E5 B0 87 E5 B0 8D E6 96 B9 E8 A8 AD E5 AE 9A E7 82 BA E9 9D 92 E5 B0 91 E5 B9 B4 E6 A8 A1 E5 BC 8F",
        "83 BD E4 B8 8D E5 8F AF E5 AD 98 E5 8F 96 00 E6 9C AA E6 88 90 E5 B9 B4 E4 BA BA E6 A8 A1 E5 BC 8F E4 B8 8B E6 AD A4 E5 8A 9F E8 83 BD E4 B8 8D !E5 8F AF E5 AD 98 E5 8F 96 00 E4 BD A0 E5 B7 B2 E5 B0 87 E5 B0 8D E6 96 B9 E8 A8 AD E5 AE 9A E7 82 BA E9 9D 92 E5 B0 91 E5 B9 B4 E6 A8 A1 E5 BC 8F"
    ]

    # 通知防撤回片段2原始串: 4.1.0.21/29/34
    hex_list_020100 = [
        "EF BC 8C E5 BB BA E8 AD B0 E9 80 80 E5 87 BA E5 BE AE E4 BF A1 E4 B8 A6 E9 87 8D E6 96 B0 E5 95 9F E5 8B 95 E9 9B BB E8 85 A6 E5 BE 8C E5 86 8D E4 BD BF E7 94 A8 E5 BE AE E4 BF A1 E3 80 82 00 ̲2̲D ̲2̲0 ̲E̲7 ̲8̲2 ̲B̲A ̲E̲7 ̲A̲2 ̲B̲A ̲E̲4 ̲B̲F ̲9̲D ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲2̲0 ̲E̲6 ̲A̲D ̲A̲3 ̲E̲5 ̲B̲8 ̲B̲8 ̲E̲4 ̲B̲D ̲B̲F ̲E̲7 ̲9̲4 ̲A̲8 ̲E̲F ̲B̲C ̲8̲C ̲E̲5 ̲B̲B ̲B̲A ̲E̲8 ̲A̲D ̲B̲0 ̲E̲9 ̲8̲0 ̲8̲0 ̲E̲5 ̲8̲7 ̲B̲A ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲2̲0 ̲E̲4 ̲B̲8 ̲A̲6 ̲E̲9 ̲8̲7 ̲8̲D ̲E̲6 ̲9̲6 ̲B̲0 ̲E̲5 ̲9̲5 ̲9̲F ̲E̲5 ̲8̲B ̲9̲5 ̲E̲9 ̲9̲B ̲B̲B ̲E̲8 ̲8̲5 ̲A̲6 ̲E̲5 ̲B̲E ̲8̲C ̲E̲5 ̲8̲6 ̲8̲D ̲E̲4 ̲B̲D ̲B̲F ̲E̲7 ̲9̲4 ̲A̲8 ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲E̲3 ̲8̲0 ̲8̲2 00 ̲2̲D ̲2̲0 ̲E̲5 ̲A̲6 ̲8̲2 ̲E̲6 ̲9̲E ̲9̲C ̲E̲7 ̲9̲5 ̲B̲0 ̲E̲5 ̲B̲8 ̲B̲8 ̲E̲4 ̲B̲B ̲8̲D ̲E̲7 ̲8̲4 ̲B̲6 ̲E̲5 ̲8̲7 ̲B̲A ̲E̲7 ̲8̲F ̲B̲E ̲E̲F ̲B̲C ̲8̲C ̲E̲5 ̲8̲F ̲A̲F ̲E̲5 ̲9̲F ̲B̲7 ̲E̲8 ̲A̲1 ̲8̲C ̲E̲7 ̲B̲3 ̲B̲B ̲E̲7 ̲B̲5 ̲B̲1 ̲E̲7 ̲A̲3 ̲8̲1 ̲E̲7 ̲A̲2 ̲9̲F ̲E̲5 ̲B̲7 ̲A̲5 ̲E̲5 ̲8̲5 ̲B̲7 ̲E̲6 ̲8̲8 ̲9̲6 ̲E̲7 ̲A̲C ̲A̲C ̲E̲4 ̲B̲8 ̲8̲9 ̲E̲6 ̲9̲6 ̲B̲9 ̲E̲5 ̲B̲7 ̲A̲5 ̲E̲5 ̲8̲5 ̲B̲7 ̲E̲5 ̲B̲0 ̲8̲D ̲E̲7 ̲A̲3 ̲8̲1 ̲E̲7 ̲A̲2 ̲9̲F ̲E̲9 ̲8̲0 ̲B̲2 ̲E̲8 ̲A̲1 ̲8̲C ̲E̲6 ̲A̲A ̲A̲2 ̲E̲6 ̲9̲F ̲A̲5 ̲E̲3 ̲8̲0 ̲8̲2 00 E7 9B AE E5 89 8D E7 B3 BB E7 B5 B1 E7 92 B0 E5 A2 83 E5 8F AF E8 83 BD E5 AD 98",
        "EF BC 8C E5 BB BA E8 AD B0 E9 80 80 E5 87 BA E5 BE AE E4 BF A1 E4 B8 A6 E9 87 8D E6 96 B0 E5 95 9F E5 8B 95 E9 9B BB E8 85 A6 E5 BE 8C E5 86 8D E4 BD BF E7 94 A8 E5 BE AE E4 BF A1 E3 80 82 00 ̲2̲D ̲2̲0 ̲E̲7 ̲8̲2 ̲B̲A ̲E̲7 ̲A̲2 ̲B̲A ̲E̲4 ̲B̲F ̲9̲D ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲2̲0 ̲E̲6 ̲A̲D ̲A̲3 ̲E̲5 ̲B̲8 ̲B̲8 ̲E̲4 ̲B̲D ̲B̲F ̲E̲7 ̲9̲4 ̲A̲8 ̲E̲F ̲B̲C ̲8̲C ̲E̲5 ̲B̲B ̲B̲A ̲E̲8 ̲A̲D ̲B̲0 ̲E̲9 ̲8̲0 ̲8̲0 ̲E̲5 ̲8̲7 ̲B̲A ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲2̲0 ̲E̲4 ̲B̲8 ̲A̲6 ̲E̲9 ̲8̲7 ̲8̲D ̲E̲6 ̲9̲6 ̲B̲0 ̲E̲5 ̲9̲5 ̲9̲F ̲E̲5 ̲8̲B ̲9̲5 ̲E̲9 ̲9̲B ̲B̲B ̲E̲8 ̲8̲5 ̲A̲6 ̲E̲5 ̲B̲E ̲8̲C ̲E̲5 ̲8̲6 ̲8̲D ̲E̲4 ̲B̲D ̲B̲F ̲E̲7 ̲9̲4 ̲A̲8 ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲E̲3 ̲8̲0 ̲8̲2 00 ̲2̲D ̲2̲0 ̲E̲5 ̲A̲6 ̲8̲2 ̲E̲6 ̲9̲E ̲9̲C ̲E̲7 ̲9̲5 ̲B̲0 ̲E̲5 ̲B̲8 ̲B̲8 ̲E̲4 ̲B̲B ̲8̲D ̲E̲7 ̲8̲4 ̲B̲6 ̲E̲5 ̲8̲7 ̲B̲A ̲E̲7 ̲8̲F ̲B̲E ̲E̲F ̲B̲C ̲8̲C ̲E̲5 ̲8̲F ̲A̲F ̲E̲5 ̲9̲F ̲B̲7 ̲E̲8 ̲A̲1 ̲8̲C ̲E̲7 ̲B̲3 ̲B̲B ̲E̲7 ̲B̲5 ̲B̲1 ̲E̲7 ̲A̲3 ̲8̲1 ̲E̲7 ̲A̲2 ̲9̲F ̲E̲5 ̲B̲7 ̲A̲5 ̲E̲5 ̲8̲5 ̲B̲7 ̲E̲6 ̲8̲8 ̲9̲6 ̲E̲7 ̲A̲C ̲A̲C ̲E̲4 ̲B̲8 ̲8̲9 ̲E̲6 ̲9̲6 ̲B̲9 ̲E̲5 ̲B̲7 ̲A̲5 ̲E̲5 ̲8̲5 ̲B̲7 ̲E̲5 ̲B̲0 ̲8̲D ̲E̲7 ̲A̲3 ̲8̲1 ̲E̲7 ̲A̲2 ̲9̲F ̲E̲9 ̲8̲0 ̲B̲2 ̲E̲8 ̲A̲1 ̲8̲C ̲E̲6 ̲A̲A ̲A̲2 ̲E̲6 ̲9̲F ̲A̲5 ̲E̲3 ̲8̲0 ̲8̲2 00 E7 9B AE E5 89 8D E7 B3 BB E7 B5 B1 E7 92 B0 E5 A2 83 E5 8F AF E8 83 BD E5 AD 98",
        "EF BC 8C E5 BB BA E8 AD B0 E9 80 80 E5 87 BA E5 BE AE E4 BF A1 E4 B8 A6 E9 87 8D E6 96 B0 E5 95 9F E5 8B 95 E9 9B BB E8 85 A6 E5 BE 8C E5 86 8D E4 BD BF E7 94 A8 E5 BE AE E4 BF A1 E3 80 82 00 ̲2̲D ̲2̲0 ̲E̲7 82 ̲B̲A ̲E̲7 ̲A̲2 ̲B̲A E4 ̲B̲F ̲9̲D ̲2̲0 ̲5̲7 ̲6̲5 ̲4̲3 ̲6̲8 ̲6̲1 ̲7̲4 ̲2̲0 ̲E̲6 ̲A̲D ̲A̲3 ̲E̲5 ̲B̲8 ̲B̲8 ̲E̲4 ̲B̲D ̲B̲F ̲E̲7 ̲9̲4 ̲A̲8 ̲E̲F ̲B̲C ̲8̲C ̲E̲5 ̲B̲B ̲B̲A ̲E̲8 ̲A̲D ̲B̲0 ̲E̲9 80 80 E5 87 BA 20 57 65 43 68 61 74 20 E4 B8 A6 E9 87 8D E6 96 B0 E5 95 9F E5 8B 95 E9 9B BB E8 85 A6 E5 BE 8C E5 86 8D E4 BD BF E7 94 A8 20 57 65 43 68 61 74 E3 80 82 00 ̲2̲D ̲2̲0 ̲E̲5 ̲A̲6 ̲8̲2 ̲E̲6 ̲9̲E ̲9̲C ̲E̲7 ̲9̲5 ̲B̲0 ̲E̲5 B8 ̲B̲8 ̲E̲4 ̲B̲B ̲8̲D ̲E̲7 ̲8̲4 ̲B̲6 ̲E̲5 ̲8̲7 ̲B̲A ̲E̲7 ̲8̲F ̲B̲E ̲E̲F ̲B̲C ̲8̲C ̲E̲5 ̲8̲F ̲A̲F ̲E̲5 9F ̲B̲7 ̲E̲8 ̲A̲1 ̲8̲C ̲E̲7 ̲B̲3 ̲B̲B E7 B5 B1 E7 A3 81 E7 A2 9F E5 B7 A5 E5 85 B7 E6 88 96 E7 AC AC ̲E̲4 ̲B̲8 ̲8̲9 ̲E̲6 ̲9̲6 ̲B̲9 ̲E̲5 ̲B̲7 ̲A̲5 ̲E̲5 ̲8̲5 ̲B̲7 ̲E̲5 ̲B̲0 ̲8̲D ̲E̲7 ̲A̲3 ̲8̲1 ̲E̲7 ̲A̲2 ̲9̲F ̲E̲9 ̲8̲0 ̲B̲2 ̲E̲8 ̲A̲1 ̲8̲C ̲E̲6 ̲A̲A ̲A̲2 ̲E̲6 ̲9̲F ̲A̲5 ̲E̲3 ̲8̲0 ̲8̲2 00 E7 9B AE E5 89 8D E7 B3 BB E7 B5 B1 E7 92 B0 E5 A2 83 E5 8F AF E8 83 BD E5 AD 98"
    ]

    # 示例
    print(extract_common_features(hex_list_020100))
